<header id="landing-header">
  
  <div class="header-left">
    <%= link_to root_path do %>
      <%= image_tag 'draper-logo.png', :class => "header-item logo" %>
    <% end %>
  </div>

  <% if current_user %>

    <div class="header-mid-left no-mobile">
      <%= form_for Search.new do |f| %>
        <%= f.text_field :terms, :class => "search-input", placeholder: "Search" %>
      <% end %>
    </div>

    <ul class="header-mid-right no-mobile">
      <li class="header-item <%= 'active' if request.original_url.include?("playlists") %>">
        <%= link_to playlists_path do %>
          SERIES
        <% end %>
      </li>
      <li class="header-item <%= 'active' if request.original_url.include?("videos") %>">
        <%= link_to videos_path do %>
          VIDEOS
        <% end %>
      </li>
      <li class="header-item <%= 'active' if request.original_url.include?("favorites") %>">
        <%= link_to favorites_path do %>
          FAVORITES
        <% end %>
      </li>
    </ul>
    <div class="header-right">
      <ul class="nav navbar-nav m-n hidden-xs nav-user user">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle bg clear header-item" data-toggle="dropdown" id="header-dropdown">
            <span class="no-mobile"><%= current_user.name %></span>
            <b class="caret no-mobile"></b>
            <span class="header-avatar">
              <%= image_tag current_user.avatar_url(:thumb).to_s %>
            </span>
          </a>
          <ul class="dropdown-menu animated fadeInRight hidden">
            <li>
              <span class="arrow top"></span>
              <%= link_to 'Profile', profile_edit_path(current_user) %>
            </li>
            <li>
              <%= link_to 'Sign out', destroy_user_session_path, :method=>'delete' %>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <%= image_tag "menu.svg", :class => "mobile-menu-icon svg no-desk" %>
    <div class="mobile-menu">
      <ul class="mobile-menu-items">
        <li class="mobile-menu-item">
          <%= link_to 'Series', playlists_path %>
        </li>
        <li class="mobile-menu-item">
          <%= link_to 'Videos', videos_path %>
        </li>
        <li class="mobile-menu-item">
          <%= link_to 'Favorites', favorites_path %>
        </li>
        <li class="mobile-menu-item">
          <%= link_to 'Profile', profile_edit_path(current_user) %>
        </li>
        <li class="mobile-menu-item">
          <%= link_to 'Sign out', destroy_user_session_path, :method=>'delete' %>
        </li>

      </ul>

    </div>
  <% else %>
    <div class="header-right">
      <div class="header-item m-xs green-btn sign-up-btn no-mobile">
      <a href="<%= new_user_registration_path %>">Sign Up</a></div>
      <div class="header-item or no-mobile">
        or
      </div>
      <div class="header-item m-xs" id="login">
        <p id="login-modal-trigger">Log In</p>
        <%= render partial: "layouts/login_modal" %>
      </div>
    </div>
  <% end %>
</header>



<script>
  $('img.svg').each(function(){
    var $img = $(this);
    var imgID = $img.attr('id');
    var imgClass = $img.attr('class');
    var imgURL = $img.attr('src');
    $.get(imgURL, function(data) {
        // Get the SVG tag, ignore the rest
        var $svg = $(data).find('svg');
        // Add replaced image's ID to the new SVG
        if(typeof imgID !== 'undefined') {
            $svg = $svg.attr('id', imgID);
        }
        // Add replaced image's classes to the new SVG
        if(typeof imgClass !== 'undefined') {
            $svg = $svg.attr('class', imgClass+' replaced-svg');
        }
        // Remove any invalid XML tags as per http://validator.w3.org
        $svg = $svg.removeAttr('xmlns:a');
        // Replace image with new SVG
        $img.replaceWith($svg);
        $img.show()
    }, 'xml');
  });
</script>
